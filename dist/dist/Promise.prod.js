"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var PENDING="PENDING",RESOLVED="RESOLVED",REJECTED="REJECTED";function resolvePromise(t,e,r,o){t===e&&o(new TypeError("# Chaining cycle detected for promise #<Promise>"));var n=!1;if("object"===_typeof(e)&&null!=e||"function"==typeof e)try{var s=e.then;"function"==typeof s?s.call(e,function(e){n||(n=!0,resolvePromise(t,e,r,o))},function(e){n||(n=!0,o(e))}):r(e)}catch(e){if(n)return;n=!0,o(e)}else r(e)}var Promise=function(){function c(e){var r=this;_classCallCheck(this,c),this.status=PENDING,this.value=this.reason=void 0,this.rejectedCallBacks=[],this.resolvedCallBacks=[];var o=function(e){r.status===PENDING&&(r.status=REJECTED,r.reason=e,r.rejectedCallBacks.forEach(function(e){return e()}))};try{e(function e(t){if(t instanceof c)return t.then(e,o);r.status===PENDING&&(r.status=RESOLVED,r.value=t,r.resolvedCallBacks.forEach(function(e){return e()}))},o)}catch(e){o(e)}}return _createClass(c,[{key:"then",value:function(o,n){var s=this;o="function"==typeof o?o:function(e){return e},n="function"==typeof n?n:function(e){throw e};var i=new c(function(t,r){s.status===RESOLVED&&setTimeout(function(){try{var e=o(s.value);resolvePromise(i,e,t,r)}catch(e){r(e)}},0),s.status===REJECTED&&setTimeout(function(){try{var e=n(s.reason);resolvePromise(i,e,t,r)}catch(e){r(e)}},0),s.status===PENDING&&(s.rejectedCallBacks.push(function(){setTimeout(function(){try{var e=n(s.reason);resolvePromise(i,e,t,r)}catch(e){r(e)}},0)}),s.resolvedCallBacks.push(function(){setTimeout(function(){try{var e=o(s.value);resolvePromise(i,e,t,r)}catch(e){r(e)}},0)}))});return i}}]),c}();(module.exports=Promise).defer=Promise.deferred=function(){var r={};return r.promise=new Promise(function(e,t){r.resolve=e,r.reject=t}),r};